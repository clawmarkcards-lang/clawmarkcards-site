<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claw Mark Cards — Home</title>
  <style>
    @font-face {
      font-family: 'Workout';
      src: url('workout.otf') format('opentype');
      font-weight: normal;
      font-style: normal;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: radial-gradient(circle at top, #1a1a1a 0, #050505 55%, #000 100%);
      color: #ffffff;
    }

    a {
      color: #00c8ff;
    }

    .cmc-header--orange {
      background: #ff6a00;
      border-bottom: 3px solid #007bff;
    }

    .cmc-header {
      padding: 20px;
      text-align: center;
    }

    .cmc-header .site-title {
      margin: 0;
      font-size: 2.6em;
      font-family: 'Workout', Arial, sans-serif;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: #ffffff;
      text-shadow: 0 0 10px rgba(0,0,0,0.6);
    }

    .cmc-header .site-motto {
      margin: 4px 0 0;
      font-size: 0.95em;
      color: #fff4e6;
      letter-spacing: 0.5px;
    }

    .cmc-nav {
      margin-top: 10px;
    }

    .cmc-nav a {
      margin: 0 12px;
      color: #ffffff;
      text-decoration: none;
      font-weight: bold;
      font-size: 0.95em;
    }

    .cmc-nav a:hover {
      color: #00c8ff;
    }

    .hero {
      max-width: 1100px;
      margin: 20px auto;
      padding: 20px;
      display: grid;
      grid-template-columns: 1fr 1.2fr 1fr;
      gap: 20px;
      align-items: center;
    }

    .hero-left,
    .hero-right {
      text-align: center;
    }

    .hero-center {
      text-align: center;
    }

    .hero-left img,
    .hero-right img {
      max-width: 100%;
      border-radius: 10px;
      box-shadow: 0 0 20px rgba(0,0,0,0.7);
    }

    /* Glowing logo section */
    #logo-container {
      display: flex;
      justify-content: center;
      align-items: center;
      background: radial-gradient(circle at top, #141414 0, #050505 60%, #000 100%);
      border-radius: 20px;
      padding: 30px 20px;
      box-shadow:
        0 0 40px rgba(0, 200, 255, 0.35),
        0 0 70px rgba(255, 106, 0, 0.35);
      position: relative;
      overflow: hidden;
    }

    #logo-glow-ring {
      position: absolute;
      inset: 0;
      border-radius: 20px;
      pointer-events: none;
      border: 2px solid rgba(0, 200, 255, 0.3);
      box-shadow:
        0 0 35px rgba(0, 200, 255, 0.4),
        inset 0 0 30px rgba(255, 106, 0, 0.4);
      opacity: 0.9;
      animation: ringPulse 6s ease-in-out infinite;
    }

    @keyframes ringPulse {
      0% { opacity: 0.4; box-shadow: 0 0 15px #00c8ff, inset 0 0 10px #ff6a00; }
      50% { opacity: 1; box-shadow: 0 0 30px #00c8ff, inset 0 0 18px #ff6a00; }
      100% { opacity: 0.4; box-shadow: 0 0 15px #00c8ff, inset 0 0 10px #ff6a00; }
    }

    #logo {
      max-width: 300px;
      margin: 0 20px;
      display: block;
      animation: fadeIn 2s ease-out, rotateShadow 5s linear infinite;
    }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    @keyframes rotateShadow {
      0% { box-shadow: 0 0 15px #00c8ff; }
      25% { box-shadow: 0 0 25px #00c8ff; }
      50% { box-shadow: 0 0 40px #00c8ff; }
      75% { box-shadow: 0 0 25px #00c8ff; }
      100% { box-shadow: 0 0 15px #00c8ff; }
    }

    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Info bar */
    .info-bar {
      background: #101010;
      border-radius: 10px;
      padding: 12px 16px;
      border: 1px solid #333;
      box-shadow: 0 0 16px rgba(0,0,0,0.6);
      margin-bottom: 10px;
      font-size: 0.95em;
    }

    .info-bar strong {
      color: #ffcc00;
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }

    .info-bar a {
      color: #00c8ff;
      font-weight: bold;
      text-decoration: none;
    }

    .info-bar a:hover {
      text-decoration: underline;
    }

    /* Status line */
    #cm-status-line {
      font-size: 0.9em;
      color: #dddddd;
      display: flex;
      flex-wrap: wrap;
      align-items: baseline;
      gap: 6px;
    }

    #cm-status-label {
      font-weight: bold;
      color: #ffcc00;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    #cm-user-status {
      font-weight: bold;
    }

    #cm-user-status.cm-not { color: #ff5757; }
    #cm-user-status.cm-yes  { color: #00c8ff; }
    #cm-user-status a { color: #00c8ff; text-decoration: underline; }
    #cm-user-status a:hover { filter: brightness(1.2); }

    /* Badge block */
    #cm-badge-block {
      display: none;
      margin: 6px auto 14px;
      text-align: center;
    }

    .badge-large {
      width: 180px;
      height: 180px;
      object-fit: contain;
      border-radius: 14px;
      background: #0f0f0f;
      box-shadow: 0 0 18px rgba(0,0,0,0.5);
      display: inline-block;
    }

    .badge-caption {
      margin-top: 8px;
      font-weight: 800;
      letter-spacing: 0.2px;
      color: #ffcc00;
    }

    #logout-btn {
      margin-top: 8px;
      padding: 6px 14px;
      border-radius: 14px;
      border: 1px solid #ff6a00;
      background: transparent;
      color: #ff9a3a;
      font-size: 0.85em;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 0.8px;
    }

    #logout-btn:hover {
      background: rgba(255, 106, 0, 0.15);
    }

    /* LIVE banner */
    .live-banner {
      margin-top: 10px;
      padding: 10px 14px;
      border-radius: 14px;
      background: linear-gradient(90deg, #222, #101010);
      border: 1px solid #333;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      font-size: 0.92em;
    }

    .live-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #ff3b3b;
      box-shadow: 0 0 8px #ff3b3b;
      animation: livePulse 1.5s infinite;
    }

    @keyframes livePulse {
      0% { transform: scale(1); opacity: 0.7; }
      50% { transform: scale(1.3); opacity: 1; }
      100% { transform: scale(1); opacity: 0.7; }
    }

    .live-label {
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #ffcc00;
      font-weight: bold;
    }

    .live-text {
      color: #e0e0e0;
    }

    .live-text a {
      color: #00c8ff;
      text-decoration: none;
    }

    .live-text a:hover {
      text-decoration: underline;
    }

    .live-tag {
      margin-left: auto;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #00c8ff;
      font-size: 0.75em;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      color: #00c8ff;
    }

    .hobby-section {
      margin-top: 30px;
      padding: 18px 16px 20px;
      border-radius: 12px;
      background: #111111;
      border: 1px solid #222;
      box-shadow: 0 6px 18px rgba(0,0,0,0.6);
    }

    .hobby-section h2 {
      margin-top: 0;
      font-size: 1.4em;
      color: #ff6a00;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .hobby-section p {
      color: #dddddd;
      line-height: 1.5;
      margin-bottom: 12px;
    }

    .cta-row {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .btn,
    .btn.alt {
      display: inline-block;
      padding: 10px 18px;
      border-radius: 20px;
      font-size: 0.95em;
      text-decoration: none;
      font-weight: bold;
      letter-spacing: 0.5px;
    }

    .btn {
      background: #ff6a00;
      color: #ffffff;
      border: 1px solid #ff9a3a;
      box-shadow: 0 0 14px rgba(255, 106, 0, 0.6);
    }

    .btn:hover {
      background: #ff812e;
      box-shadow: 0 0 16px rgba(255, 129, 46, 0.9);
    }

    .btn.alt {
      background: transparent;
      color: #00c8ff;
      border: 1px solid #00c8ff;
    }

    .btn.alt:hover {
      background: rgba(0, 200, 255, 0.1);
    }

    footer {
      background-color: #1e1e1e;
      text-align: center;
      padding: 15px;
      font-size: 0.9em;
      color: #aaaaaa;
    }

    /* ============================
       Store Announcement Popup
       ============================ */

    .cm-store-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.78);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 2000;
    }

    .cm-store-modal-overlay.cm-show {
      display: flex;
    }

    .cm-store-modal {
      max-width: 420px;
      width: 100%;
      background: radial-gradient(circle at top, #222 0, #111 60%, #050505 100%);
      border-radius: 14px;
      border: 1px solid #333;
      box-shadow: 0 16px 40px rgba(0,0,0,0.85);
      padding: 18px 18px 16px;
      position: relative;
    }

    .cm-store-modal-kicker {
      font-size: 0.78em;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: #ffcc00;
      margin: 0 0 4px;
    }

    .cm-store-modal h2 {
      margin: 0 0 8px;
      font-size: 1.4em;
      color: #ff6a00;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .cm-store-modal p {
      margin: 0 0 10px;
      font-size: 0.95em;
      color: #dddddd;
      line-height: 1.4;
    }

    .cm-store-modal-address {
      font-size: 0.9em;
      color: #bbbbbb;
      margin-bottom: 10px;
    }

    .cm-store-modal-hours {
      font-size: 0.9em;
      color: #bbbbbb;
      margin-bottom: 12px;
    }

    .cm-store-modal-btn {
      display: inline-block;
      padding: 9px 18px;
      border-radius: 999px;
      background: #ff6a00;
      color: #ffffff;
      text-decoration: none;
      font-size: 0.95em;
      font-weight: bold;
      border: 1px solid #ff9a3a;
      box-shadow: 0 0 14px rgba(255,106,0,0.7);
      transition: background 0.15s, box-shadow 0.15s, transform 0.15s;
    }

    .cm-store-modal-btn:hover {
      background: #ff812e;
      box-shadow: 0 0 18px rgba(255,129,46,0.9);
      transform: translateY(-1px);
    }

    .cm-store-modal-close {
      position: absolute;
      top: 8px;
      right: 10px;
      background: transparent;
      border: none;
      color: #888888;
      font-size: 1.4em;
      cursor: pointer;
      padding: 2px 4px;
    }

    .cm-store-modal-close:hover {
      color: #ffffff;
    }

    .cm-store-modal-footer {
      margin-top: 6px;
      font-size: 0.8em;
      color: #888888;
    }

    @media (max-width: 480px) {
      .cm-store-modal {
        padding: 16px 14px 14px;
      }
      .cm-store-modal h2 {
        font-size: 1.2em;
      }
    }
  </style>
</head>
<body>
<header class="cmc-header cmc-header--orange">
  <div class="brand">
    <h1 class="site-title">Claw Mark Cards</h1>
    <p class="site-motto">Every Rip Leaves Its Mark</p>
  </div>
  <div id="main-nav"></div>
</header>

  <!-- Store Popup Modal -->
  <div
    id="store-modal-overlay"
    class="cm-store-modal-overlay"
    aria-hidden="true"
  >
    <div
      class="cm-store-modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="store-modal-title"
    >
      <button
        type="button"
        class="cm-store-modal-close"
        aria-label="Close announcement"
      >&times;</button>

      <p class="cm-store-modal-kicker">New In-Person Location</p>
      <h2 id="store-modal-title">Now Open in North Myrtle Beach</h2>
      <p>
        Come see Claw Mark Cards inside <strong>Everything Under The Sun Flea Market</strong> —
        dig through value boxes, rip in person, and see what's new each week.
      </p>
      <p class="cm-store-modal-address">
        811 Hwy 17 South<br />
        North Myrtle Beach, SC 29582
      </p>
      <p class="cm-store-modal-hours">
        <strong>Hours:</strong> Wednesday – Sunday, 10:00 AM – 5:00 PM
      </p>

      <a
        href="/north-myrtle-store.html"
        class="cm-store-modal-btn"
        id="store-modal-cta"
      >
        View Store Details
      </a>

      <div class="cm-store-modal-footer">
        You'll only see this once per session.
      </div>
    </div>
  </div>

<main>
  <section class="hero">
    <div class="hero-left">
      <img src="badgesfresh.png" alt="Fresh Mark Badge" />
    </div>
    <div class="hero-center">
      <div id="logo-container">
        <div id="logo-glow-ring"></div>
        <img id="logo" src="bear.png" alt="Claw Mark Cards Logo" />
      </div>
    </div>
    <div class="hero-right">
      <img src="badgesfull.png" alt="Full Claw Badge" />
    </div>
  </section>

  <section class="info-bar">
    <div id="cm-status-line">
      <span id="cm-status-label">Account:</span>
      <span id="cm-user-status" class="cm-not">Checking status…</span>
    </div>
    <div id="cm-badge-block">
      <img id="cm-badge-img" class="badge-large" src="badgesfresh.png" alt="Tier Badge" />
      <div class="badge-caption" id="cm-badge-caption">Fresh Mark</div>
      <button id="logout-btn" type="button">Logout</button>
    </div>
  </section>

  <section class="live-banner">
    <div class="live-dot"></div>
    <div class="live-label">Live & Active</div>
    <div class="live-text">
      We’re active and ready to engage — check our shop, breaks, and in-person booth for what’s live now.
      Follow our socials to see when we go live!
    </div>
    <div class="live-tag">Hobby • Breaks • Singles</div>
  </section>

  <section class="hobby-section">
    <h2>Sports Cards • Collectibles • Breaks</h2>
    <p>
      Claw Mark Cards is built for collectors who live the hobby. From NFL, NBA, MLB, and beyond —
      sealed wax, raw singles, and slabbed grails — every rip is part of the story.
      We break, we trade, we collect, and we take care of our community.
    </p>
    <div class="cta-row">
      <a class="btn" href="tiers.html">Explore The Marked Tiers →</a>
      <a class="btn" href="rewards.html">View Rewards</a>
      <a class="btn alt" href="signup.html">Join The Marked</a>
    </div>
  </section>
</main>

<footer>
  <p>© 2025 Claw Mark Cards • Every Rip Leaves Its Mark</p>
</footer>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
(function () {
  const firebaseConfig = {
    apiKey: "AIzaSyCM5La0C7dKpWgQUpAxVQguDcEV1D4Vmms",
    authDomain: "clawmark-login.firebaseapp.com",
    projectId: "clawmark-login",
    storageBucket: "clawmark-login.firebasestorage.app",
    messagingSenderId: "334338665183",
    appId: "1:334338665183:web:eb179b820393234c74576a",
    measurementId: "G-WPW21P13VJ"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  const elStatus = document.getElementById("cm-user-status");
  const elBadge  = document.getElementById("cm-badge-block");
  const badgeImg = document.getElementById("cm-badge-img");
  const badgeCaption = document.getElementById("cm-badge-caption");
  const logoutBtn = document.getElementById("logout-btn");

  const BADGE_MAP = {
    "Fresh Mark": "badgesfresh.png",
    "Deep Scar":  "badgesdeep.png",
    "Full Claw":  "badgesfull.png"
  };

  const cleanTier = (t) => (t || "Fresh Mark").trim();
  const getBadgeSrc = (tier) => BADGE_MAP[cleanTier(tier)] || BADGE_MAP["Fresh Mark"];

  function showNot() {
    elStatus.className = "cm-not";
    elStatus.innerHTML = 'Not logged in. <a href="login.html">Login</a> or <a href="signup.html">Sign up</a> to start climbing the Marked Tiers.';
    elBadge.style.display = "none";
  }

  function showYes(email, tier, points) {
    elStatus.className = "cm-yes";
    elStatus.textContent = email + " • " + tier + " • " + points + " pts";
    elBadge.style.display = "block";
    badgeImg.src = getBadgeSrc(tier);
    badgeCaption.textContent = cleanTier(tier);
  }

  auth.onAuthStateChanged((user) => {
    if (!user) {
      showNot();
      return;
    }

    db.collection("users").doc(user.uid).get()
      .then((doc) => {
        const data = doc.exists ? doc.data() : {};
        showYes(
          (data.email || user.email),
          (data.tier || "Fresh Mark"),
          (typeof data.points === "number" ? data.points : 0)
        );
      })
      .catch((err) => {
        console.error("Error fetching user doc:", err);
        showYes(user.email, "Fresh Mark", 0);
      });
  });

  logoutBtn.addEventListener("click", () => {
    auth.signOut().then(() => showNot())
      .catch((err) => {
        console.error("Logout error:", err);
        alert("Logout failed: " + err.message);
      });
  });
})();
</script>

<script>
  // Load shared navigation
  fetch("nav.html")
    .then(response => response.text())
    .then(html => {
      const container = document.getElementById("main-nav");
      if (container) container.innerHTML = html;
    })
    .catch(err => {
      console.error("Navigation failed to load:", err);
    });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const overlay = document.getElementById("store-modal-overlay");
    if (!overlay) return;

    const closeBtn = overlay.querySelector(".cm-store-modal-close");
    const ctaBtn = document.getElementById("store-modal-cta");
    const FLAG_KEY = "cmStorePopupShown";

    function showModal() {
      overlay.classList.add("cm-show");
      overlay.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";
    }

    function hideModal() {
      overlay.classList.remove("cm-show");
      overlay.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
      try {
        sessionStorage.setItem(FLAG_KEY, "1");
      } catch (e) {
        console.warn("Session storage not available", e);
      }
    }

    let alreadyShown = false;
    try {
      alreadyShown = sessionStorage.getItem(FLAG_KEY) === "1";
    } catch (e) {
      alreadyShown = false;
    }

    if (!alreadyShown) {
      setTimeout(showModal, 500);
    }

    if (closeBtn) {
      closeBtn.addEventListener("click", hideModal);
    }

    overlay.addEventListener("click", function (e) {
      if (e.target === overlay) {
        hideModal();
      }
    });

    if (ctaBtn) {
      ctaBtn.addEventListener("click", function () {
        try {
          sessionStorage.setItem(FLAG_KEY, "1");
        } catch (e) {}
      });
    }

    document.addEventListener("keydown", function (e) {
      if (e.key === "Escape" && overlay.classList.contains("cm-show")) {
        hideModal();
      }
    });
  });
</script>
</body>
</html>
