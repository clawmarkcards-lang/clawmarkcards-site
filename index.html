<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claw Mark Cards ‚Äî Home</title>
  <style>
    @font-face {
      font-family: 'Workout';
      src: url('workout.otf') format('opentype');
      font-weight: normal;
      font-style: normal;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: radial-gradient(circle at top, #1a1a1a 0, #050505 55%, #000 100%);
      color: #ffffff;
    }

    a {
      color: #00c8ff;
    }

    /* Header styling */
    .cmc-header--orange {
      background: #ff6a00;
      border-bottom: 3px solid #007bff;
    }
    .cmc-header {
      padding: 20px;
      text-align: center;
    }
    .cmc-header .site-title {
      margin: 0;
      font-size: 2.6em;
      font-family: 'Workout', Arial, sans-serif;
      letter-spacing: 1px;
      text-transform: uppercase;
      color: #ffffff;
      text-shadow: 0 0 10px rgba(0,0,0,0.6);
    }
    .cmc-header .site-motto {
      margin: 4px 0 0;
      font-size: 0.95em;
      color: #fff4e6;
      letter-spacing: 0.5px;
    }

    .cmc-nav {
      margin-top: 10px;
    }
    .cmc-nav a {
      margin: 0 12px;
      color: #ffffff;
      text-decoration: none;
      font-weight: bold;
      font-size: 0.95em;
    }
    .cmc-nav a:hover {
      color: #00c8ff;
    }

    /* Announcement bar */
    #announcement {
      margin: 12px auto 8px;
      max-width: 1100px;
      padding: 10px 14px;
      border-radius: 14px;
      background: linear-gradient(90deg, #222, #101010);
      border: 1px solid #333;
      font-size: 0.92em;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.7);
    }

    /* üî• Status line */
    #cm-user-status {
      margin: 12px auto 4px;
      text-align: center;
      font-weight: 800;
      font-size: 1.1em;
      padding: 0 12px;
      max-width: 1100px;
    }
    #cm-user-status.cm-not { color: #ff5757; }
    #cm-user-status.cm-yes  { color: #00c8ff; }
    #cm-user-status a { color: #00c8ff; text-decoration: underline; }
    #cm-user-status a:hover { filter: brightness(1.2); }

    /* üõ°Ô∏è BIG badge block (separate from status line) */
    #cm-badge-block {
      display: none; /* shown when logged in */
      margin: 6px auto 14px;
      text-align: center;
    }
    .badge-large {
      width: 180px;
      height: 180px;
      object-fit: contain;
      border-radius: 14px;
      background: #0f0f0f;
      box-shadow: 0 0 18px rgba(0,0,0,0.5);
      display: inline-block;
    }
    .badge-caption {
      margin-top: 8px;
      font-weight: 800;
      letter-spacing: 0.2px;
      color: #ffcc00;
    }

    #logout-btn {
      display: none;
      margin: 0 auto 10px;
      padding: 6px 14px;
      border-radius: 14px;
      border: 1px solid #ff6a00;
      background: transparent;
      color: #ff9a3a;
      font-size: 0.85em;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      display: block;
    }
    #logout-btn:hover {
      background: rgba(255, 106, 0, 0.15);
    }

    /* Main glow / logo section */
    .main-container {
      max-width: 1100px;
      margin: 10px auto 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 14px;
      padding: 0 12px;
    }

    .glow-container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .glow-container.right {
      justify-content: center;
    }

    .side-img {
      max-width: 100%;
      max-height: 260px;
      border-radius: 16px;
      box-shadow:
        0 0 20px rgba(0, 200, 255, 0.4),
        0 0 40px rgba(255, 106, 0, 0.4);
      background: #111;
    }

    #logo {
      max-width: 320px;
      width: 100%;
      height: auto;
      display: block;
      animation: fadeIn 2s ease-out, rotateShadow 5s linear infinite;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes rotateShadow {
      0%   { filter: drop-shadow(0 0 10px #00c8ff); }
      25%  { filter: drop-shadow(0 0 20px #00c8ff); }
      50%  { filter: drop-shadow(0 0 28px #00c8ff); }
      75%  { filter: drop-shadow(0 0 20px #00c8ff); }
      100% { filter: drop-shadow(0 0 10px #00c8ff); }
    }

    /* Content section */
    .hobby-section {
      max-width: 1100px;
      margin: 0 auto 25px;
      padding: 18px 16px 20px;
      border-radius: 12px;
      background: #111111;
      border: 1px solid #222;
      box-shadow: 0 6px 18px rgba(0,0,0,0.6);
    }

    .hobby-section h2 {
      margin-top: 0;
      font-size: 1.4em;
      color: #ff6a00;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .hobby-section p {
      color: #dddddd;
      line-height: 1.5;
      margin-bottom: 12px;
    }

    .cta-row {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .btn,
    .btn.alt {
      display: inline-block;
      padding: 10px 18px;
      border-radius: 20px;
      font-size: 0.95em;
      text-decoration: none;
      font-weight: bold;
      letter-spacing: 0.5px;
    }

    .btn {
      background: #ff6a00;
      color: #ffffff;
      border: 1px solid #ff9a3a;
      box-shadow: 0 0 14px rgba(255, 106, 0, 0.6);
    }

    .btn:hover {
      background: #ff812e;
      box-shadow: 0 0 16px rgba(255, 129, 46, 0.9);
    }

    .btn.alt {
      background: transparent;
      color: #00c8ff;
      border: 1px solid #00c8ff;
    }

    .btn.alt:hover {
      background: rgba(0, 200, 255, 0.1);
    }

    footer {
      background-color: #1e1e1e;
      text-align: center;
      padding: 15px;
      font-size: 0.9em;
      color: #aaaaaa;
    }

    /* ============================
       Store Announcement Popup
       ============================ */

    .cm-store-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.78);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 16px;
      z-index: 2000;
    }

    .cm-store-modal-overlay.cm-show {
      display: flex;
    }

    .cm-store-modal {
      max-width: 420px;
      width: 100%;
      background: radial-gradient(circle at top, #222 0, #111 60%, #050505 100%);
      border-radius: 14px;
      border: 1px solid #333;
      box-shadow: 0 16px 40px rgba(0,0,0,0.85);
      padding: 18px 18px 16px;
      position: relative;
    }

    .cm-store-modal-kicker {
      font-size: 0.78em;
      letter-spacing: 1.5px;
      text-transform: uppercase;
      color: #ffcc00;
      margin: 0 0 4px;
    }

    .cm-store-modal h2 {
      margin: 0 0 8px;
      font-size: 1.4em;
      color: #ff6a00;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .cm-store-modal p {
      margin: 0 0 10px;
      font-size: 0.95em;
      color: #dddddd;
      line-height: 1.4;
    }

    .cm-store-modal-address {
      font-size: 0.9em;
      color: #bbbbbb;
      margin-bottom: 10px;
    }

    .cm-store-modal-hours {
      font-size: 0.9em;
      color: #bbbbbb;
      margin-bottom: 12px;
    }

    .cm-store-modal-btn {
      display: inline-block;
      padding: 9px 18px;
      border-radius: 999px;
      background: #ff6a00;
      color: #ffffff;
      text-decoration: none;
      font-size: 0.95em;
      font-weight: bold;
      border: 1px solid #ff9a3a;
      box-shadow: 0 0 14px rgba(255,106,0,0.7);
      transition: background 0.15s, box-shadow 0.15s, transform 0.15s;
    }

    .cm-store-modal-btn:hover {
      background: #ff812e;
      box-shadow: 0 0 18px rgba(255,129,46,0.9);
      transform: translateY(-1px);
    }

    .cm-store-modal-close {
      position: absolute;
      top: 8px;
      right: 10px;
      background: transparent;
      border: none;
      color: #888888;
      font-size: 1.4em;
      cursor: pointer;
      padding: 2px 4px;
    }

    .cm-store-modal-close:hover {
      color: #ffffff;
    }

    .cm-store-modal-footer {
      margin-top: 6px;
      font-size: 0.8em;
      color: #888888;
    }

    @media (max-width: 480px) {
      .cm-store-modal {
        padding: 16px 14px 14px;
      }
      .cm-store-modal h2 {
        font-size: 1.2em;
      }
    }
  </style>
</head>
<body>
<header class="cmc-header cmc-header--orange">
  <div class="brand">
    <h1 class="site-title">Claw Mark Cards</h1>
    <p class="site-motto">Every Rip Leaves Its Mark</p>
  </div>
  <div id="main-nav"></div>
</header>

  <!-- Store Popup Modal -->
  <div
    id="store-modal-overlay"
    class="cm-store-modal-overlay"
    aria-hidden="true"
  >
    <div
      class="cm-store-modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="store-modal-title"
    >
      <button
        type="button"
        class="cm-store-modal-close"
        aria-label="Close announcement"
      >&times;</button>

      <p class="cm-store-modal-kicker">New In-Person Location</p>
      <h2 id="store-modal-title">Now Open in North Myrtle Beach</h2>
      <p>
        Come see Claw Mark Cards inside <strong>Everything Under The Sun Flea Market</strong> ‚Äî
        dig through value boxes, rip in person, and see what's new each week.
      </p>
      <p class="cm-store-modal-address">
        811 Hwy 17 South<br />
        North Myrtle Beach, SC 29582
      </p>
      <p class="cm-store-modal-hours">
        <strong>Hours:</strong> Wednesday ‚Äì Sunday, 10:00 AM ‚Äì 5:00 PM
      </p>

      <a
        href="/north-myrtle-store.html"
        class="cm-store-modal-btn"
        id="store-modal-cta"
      >
        View Store Details
      </a>

      <div class="cm-store-modal-footer">
        You'll only see this once per session.
      </div>
    </div>
  </div>

  <!-- üîî LIVE banner -->
  <div id="announcement">
    ‚ö° We‚Äôre active and ready to engage ‚Äî follow us on <b>Facebook</b>, <b>TikTok</b>, and
    <b>Snapchat</b>. Tap <a href="social.html" style="color:#00c8ff; text-decoration:underline;">Social</a> to join The Marked.
  </div>

  <!-- Status + big badge + logout -->
  <div id="cm-user-status">Loading status...</div>
  <div id="cm-badge-block"></div>
  <button id="logout-btn">Log Out</button>

  <main class="main-container">
    <div class="glow-container">
      <img class="side-img" src="bear.png" alt="Bear">
    </div>
    <img id="logo" src="logo.png" alt="Claw Mark Cards Logo">
    <div class="glow-container right">
      <img class="side-img" src="panther.png" alt="Panther">
    </div>
  </main>

  <!-- Sports Cards & Collectibles anchor -->
  <section class="hobby-section">
    <h2>Sports Cards ‚Ä¢ Collectibles ‚Ä¢ Breaks</h2>
    <p>
      Claw Mark Cards is built for collectors who live the hobby. From NFL, NBA, MLB, and beyond ‚Äî
      sealed wax, raw singles, and slabbed grails ‚Äî every rip is part of the story.
      We break, we trade, we collect, and we take care of our community.
    </p>
    <div class="cta-row">
      <a class="btn" href="tiers.html">Explore The Marked Tiers ‚Üí</a>
      <a class="btn" href="rewards.html">View Rewards</a>
      <a class="btn alt" href="signup.html">Join The Marked</a>
    </div>
  </section>

  <footer>
    <p>¬© 2025 Claw Mark Cards ‚Ä¢ Every Rip Leaves Its Mark</p>
  </footer>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
  (function () {
    const firebaseConfig = {
      apiKey: "AIzaSyCM5La0C7dKpWgQUpAxVQguDcEV1D4Vmms",
      authDomain: "clawmark-login.firebaseapp.com",
      projectId: "clawmark-login",
      storageBucket: "clawmark-login.firebasestorage.app",
      messagingSenderId: "334338665183",
      appId: "1:334338665183:web:eb179b820393234c74576a",
      measurementId: "G-WPW21P13VJ"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const elStatus = document.getElementById("cm-user-status");
    const elBadge  = document.getElementById("cm-badge-block");
    const logoutBtn = document.getElementById("logout-btn");

    const BADGE_MAP = {
      "Fresh Mark": "badgesfresh.png",
      "Deep Scar":  "badgesdeep.png",
      "Full Claw":  "badgesfull.png"
    };

    const cleanTier = (t) => (t || "Fresh Mark").trim();
    const getBadgeSrc = (tier) => BADGE_MAP[cleanTier(tier)] || BADGE_MAP["Fresh Mark"];

    function showNot() {
      elStatus.className = "cm-not";
      elStatus.innerHTML =
        'Not logged in. <a href="login.html">Login</a> or <a href="signup.html">Sign up</a> to start climbing the Marked Tiers.';
      elBadge.style.display = "none";
      elBadge.innerHTML = "";
      logoutBtn.style.display = "none";
    }

    function showYes(email, tier, points) {
      const safeTier = cleanTier(tier);
      const pts = (typeof points === "number" ? points : 0);

      elStatus.className = "cm-yes";
      elStatus.innerHTML = `üîê Logged in as: ${email} ‚Ä¢ üèÜ Tier: ${safeTier}`;

      const badgeSrc = getBadgeSrc(safeTier);
      elBadge.style.display = "block";
      elBadge.innerHTML = `
        <img class="badge-large" src="${badgeSrc}" alt="${safeTier} badge"
             onerror="this.style.display='none'">
        <div class="badge-caption">Points: ${pts}</div>
      `;

      logoutBtn.style.display = "block";
    }

    auth.onAuthStateChanged((user) => {
      if (!user) {
        showNot();
        return;
      }

      db.collection("users").doc(user.uid).get()
        .then((doc) => {
          const data = doc.exists ? doc.data() : {};
          showYes(
            (data.email || user.email),
            (data.tier || "Fresh Mark"),
            (typeof data.points === "number" ? data.points : 0)
          );
        })
        .catch(() => showYes(user.email, "Fresh Mark", 0));
    });

    logoutBtn.addEventListener("click", () => {
      auth.signOut().then(() => showNot())
        .catch((err) => {
          console.error("Logout error:", err);
          alert("Logout failed: " + err.message);
        });
    });
  })();
  </script>

  <script>
    // Load shared navigation from nav.html
    fetch("nav.html")
      .then(response => response.text())
      .then(html => {
        const container = document.getElementById("main-nav");
        if (container) container.innerHTML = html;
      })
      .catch(err => {
        console.error("Navigation failed to load:", err);
      });
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const overlay = document.getElementById("store-modal-overlay");
      if (!overlay) return;

      const closeBtn = overlay.querySelector(".cm-store-modal-close");
      const ctaBtn = document.getElementById("store-modal-cta");
      const FLAG_KEY = "cmStorePopupShown";

      function showModal() {
        overlay.classList.add("cm-show");
        overlay.setAttribute("aria-hidden", "false");
        document.body.style.overflow = "hidden";
      }

      function hideModal() {
        overlay.classList.remove("cm-show");
        overlay.setAttribute("aria-hidden", "true");
        document.body.style.overflow = "";
        try {
          sessionStorage.setItem(FLAG_KEY, "1");
        } catch (e) {
          console.warn("Session storage not available", e);
        }
      }

      let alreadyShown = false;
      try {
        alreadyShown = sessionStorage.getItem(FLAG_KEY) === "1";
      } catch (e) {
        alreadyShown = false;
      }

      if (!alreadyShown) {
        setTimeout(showModal, 500);
      }

      if (closeBtn) {
        closeBtn.addEventListener("click", hideModal);
      }

      overlay.addEventListener("click", function (e) {
        if (e.target === overlay) {
          hideModal();
        }
      });

      if (ctaBtn) {
        ctaBtn.addEventListener("click", function () {
          try {
            sessionStorage.setItem(FLAG_KEY, "1");
          } catch (e) {}
        });
      }

      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape" && overlay.classList.contains("cm-show")) {
          hideModal();
        }
      });
    });
  </script>
</body>
</html>
